cd ~/mmx || { echo "âŒ ~/mmx not found"; exit 1; }

OK=1

# 1) README present
test -f README.md && echo "âœ… README.md exists" || { echo "âŒ README.md missing"; OK=0; }

# 2) Placeholder replaced
if grep -q "__TAP__" README.md; then
  echo "âŒ __TAP__ placeholder still present in README.md"
  OK=0
else
  echo "âœ… Tap placeholder replaced"
fi

# 3) Code fences/backticks present literally
if grep -q '^```bash$' README.md && grep -q 'mmx-remux in.mp4 out.mkv' README.md; then
  echo "âœ… Code fences/backticks preserved as text"
else
  echo "âŒ Expected code fence or inline backticks not found"
  OK=0
fi

# 4) Show the Homebrew block so you can eyeball it
echo
echo "â”€â”€ Homebrew block preview â”€â”€"
awk '/^### Homebrew/,/^```$/' README.md
echo "â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€"
echo

# 5) Release checklist present
test -f RELEASE_CHECKLIST.md && echo "âœ… RELEASE_CHECKLIST.md exists" || { echo "âŒ RELEASE_CHECKLIST.md missing"; OK=0; }

# 6) If this repo is git-initialized, show the last commit that added the docs
if [ -d .git ]; then
  echo
  echo "â”€â”€ Git status â”€â”€"
  git status --porcelain=v1
  echo
  echo "â”€â”€ Last commit â”€â”€"
  git log -1 --oneline
fi

# Summary
echo
[ "$OK" -eq 1 ] && echo "ğŸ‰ Looks good." || echo "âš ï¸ See issues above."
